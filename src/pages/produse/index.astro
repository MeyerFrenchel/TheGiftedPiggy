---
import PageLayout from "@layouts/PageLayout.astro";
import SectionHeading from "@components/ui/SectionHeading.astro";
import ProductGrid from "@components/products/ProductGrid.astro";
import ProductCTA from "@components/products/ProductCTA.astro";
import { createServiceClient } from "@lib/supabase";
import { useTranslations } from "@i18n/utils";

const lang = "ro";
const t = useTranslations(lang);

const supabase = createServiceClient();
const { data: products } = await supabase
  .from("products")
  .select("*")
  .eq("in_stock", true)
  .order("created_at", { ascending: false });
---

<PageLayout
  title={t("products.title")}
  description={t("products.subtitle")}
  lang={lang}
>
  <div class="container mx-auto px-4 py-12">
    <SectionHeading
      title={t("products.title")}
      subtitle={t("products.subtitle")}
      as="h1"
    />
    <ProductGrid products={products ?? []} {lang} />
    <ProductCTA {lang} />
  </div>
</PageLayout>
