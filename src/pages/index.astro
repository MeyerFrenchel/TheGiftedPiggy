---
import { getImage } from "astro:assets";
import PageLayout from "@layouts/PageLayout.astro";
import Hero from "@components/home/Hero.astro";
import FeaturedProducts from "@components/home/FeaturedProducts.astro";
import LatestPosts from "@components/home/LatestPosts.astro";
import StructuredData from "@components/seo/StructuredData.astro";
import { getCollection } from "astro:content";
import { siteConfig } from "@data/site-config";
import heroImageSrc from "@assets/images/hero/hero-artist.jpg";

const lang = "ro";

const heroImage = await getImage({ src: heroImageSrc, format: "webp", width: 520, height: 520, quality: 85 });

const allPosts = await getCollection("blog", ({ data }) => !data.draft && data.lang === "ro");
const sortedPosts = allPosts.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<PageLayout
  lang={lang}
  title={undefined}
  description={siteConfig.description.ro}
  structuredDataType="website"
  preloadImage={heroImage.src}
>
  <StructuredData type="website" {lang} slot="head" />
  <Hero {lang} />
  <FeaturedProducts {lang} />
  <LatestPosts posts={sortedPosts} {lang} />
</PageLayout>
